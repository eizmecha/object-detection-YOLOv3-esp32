<?xml version="1.0" ?>
<sdf version="1.9">
  <model name="standard_vtol">
    <pose>0 0 0.25 0 0 0</pose>

    <link name='base_link'>
      <pose>0 0 0 0 0 0</pose>
      <inertial>
        <pose>0 0 0 0 0 0</pose>
        <mass>2.8</mass>
        <inertia>
          <ixx>0.2</ixx><ixy>0</ixy><ixz>0</ixz>
          <iyy>0.15</iyy><iyz>0</iyz><izz>0.3</izz>
        </inertia>
      </inertial>
      
      <collision name='base_link_collision'>
        <pose>0 0 -0.05 0 0 0</pose>
        <geometry><box><size>0.70 1.13 0.12</size></box></geometry>
        <surface><friction><ode><mu>100.0</mu><mu2>50.0</mu2></ode></friction></surface>
      </collision>

      <visual name='base_link_visual'>
        <geometry><mesh><scale>0.52 0.52 0.52</scale><uri>model://standard_vtol/meshes/x8_wing.dae</uri></mesh></geometry>
        <material><ambient>0.05 0.05 0.05 1</ambient><diffuse>0.05 0.05 0.05 1</diffuse></material>
      </visual>

      <visual name='left_boom'><pose>-0.06 0.18 -0.0175 0 1.5707 0</pose><geometry><cylinder><length>0.50</length><radius>0.008</radius></cylinder></geometry><material><ambient>0.2 0.2 0.2 1</ambient><diffuse>0.2 0.2 0.2 1</diffuse></material></visual>
      <visual name='right_boom'><pose>-0.06 -0.18 -0.0175 0 1.5707 0</pose><geometry><cylinder><length>0.50</length><radius>0.008</radius></cylinder></geometry><material><ambient>0.2 0.2 0.2 1</ambient><diffuse>0.2 0.2 0.2 1</diffuse></material></visual>
      
      <visual name='motor_fr'><pose>0.19 -0.18 0.003 0 0 0</pose><geometry><cylinder><length>0.025</length><radius>0.016</radius></cylinder></geometry><material><ambient>0 0 0 1</ambient><diffuse>0 0 0 1</diffuse></material></visual>
      <visual name='motor_rr'><pose>-0.31 -0.18 0.003 0 0 0</pose><geometry><cylinder><length>0.025</length><radius>0.016</radius></cylinder></geometry><material><ambient>0 0 0 1</ambient><diffuse>0 0 0 1</diffuse></material></visual>
      <visual name='motor_fl'><pose>0.19 0.18 0.003 0 0 0</pose><geometry><cylinder><length>0.025</length><radius>0.016</radius></cylinder></geometry><material><ambient>0 0 0 1</ambient><diffuse>0 0 0 1</diffuse></material></visual>
      <visual name='motor_rl'><pose>-0.31 0.18 0.003 0 0 0</pose><geometry><cylinder><length>0.025</length><radius>0.016</radius></cylinder></geometry><material><ambient>0 0 0 1</ambient><diffuse>0 0 0 1</diffuse></material></visual>
      <visual name='motor_pusher_body'><pose>-0.16 0 0 0 1.5707 0</pose><geometry><cylinder><length>0.035</length><radius>0.018</radius></cylinder></geometry><material><ambient>0 0 0 1</ambient><diffuse>0 0 0 1</diffuse></material></visual>
    </link>

    <plugin filename="gz-sim-lift-drag-system" name="gz::sim::systems::LiftDrag"><a0>0.13</a0><cla>3.7</cla><cda>0.06</cda><area>0.31</area><air_density>1.2041</air_density><forward>1 0 0</forward><upward>0 0 1</upward><link_name>base_link</link_name></plugin>

    <link name='rotor_0'><pose>0.19 -0.18 0.02 0 0 0</pose>
      <inertial><mass>0.02</mass><inertia><ixx>1e-5</ixx><iyy>1e-5</iyy><izz>1e-5</izz></inertia></inertial>
      <visual name='v'><geometry><mesh><scale>0.7 0.7 0.7</scale><uri>model://standard_vtol/meshes/iris_prop_ccw.dae</uri></mesh></geometry><material><ambient>0 0 1 1</ambient><diffuse>0 0 1 1</diffuse></material></visual>
    </link>
    <joint name='rotor_0_joint' type='revolute'><child>rotor_0</child><parent>base_link</parent><axis><xyz>0 0 1</xyz><limit><lower>-1e16</lower><upper>1e16</upper></limit></axis></joint>
    <plugin filename="gz-sim-lift-drag-system" name="gz::sim::systems::LiftDrag">
      <a0>0.3</a0><cla>4.25</cla><cda>0.10</cda><area>0.01</area><air_density>1.2041</air_density>
      <cp>0.005 0 0</cp> <forward>0 1 0</forward><upward>0 0 1</upward><link_name>rotor_0</link_name>
    </plugin>

    <link name='rotor_1'><pose>-0.31 0.18 0.02 0 0 0</pose>
      <inertial><mass>0.02</mass><inertia><ixx>1e-5</ixx><iyy>1e-5</iyy><izz>1e-5</izz></inertia></inertial>
      <visual name='v'><geometry><mesh><scale>0.7 0.7 0.7</scale><uri>model://standard_vtol/meshes/iris_prop_ccw.dae</uri></mesh></geometry><material><ambient>0 0 1 1</ambient><diffuse>0 0 1 1</diffuse></material></visual>
    </link>
    <joint name='rotor_1_joint' type='revolute'><child>rotor_1</child><parent>base_link</parent><axis><xyz>0 0 1</xyz></axis></joint>
    <plugin filename="gz-sim-lift-drag-system" name="gz::sim::systems::LiftDrag">
      <a0>0.3</a0><cla>4.25</cla><cda>0.10</cda><area>0.01</area><air_density>1.2041</air_density>
      <cp>0.005 0 0</cp><forward>0 1 0</forward><upward>0 0 1</upward><link_name>rotor_1</link_name>
    </plugin>

    <link name='rotor_2'><pose>0.19 0.18 0.02 0 0 0</pose>
      <inertial><mass>0.02</mass><inertia><ixx>1e-5</ixx><iyy>1e-5</iyy><izz>1e-5</izz></inertia></inertial>
      <visual name='v'><geometry><mesh><scale>0.7 0.7 0.7</scale><uri>model://standard_vtol/meshes/iris_prop_cw.dae</uri></mesh></geometry><material><ambient>0 0 1 1</ambient><diffuse>0 0 1 1</diffuse></material></visual>
    </link>
    <joint name='rotor_2_joint' type='revolute'><child>rotor_2</child><parent>base_link</parent><axis><xyz>0 0 1</xyz></axis></joint>
    <plugin filename="gz-sim-lift-drag-system" name="gz::sim::systems::LiftDrag">
      <a0>0.3</a0><cla>4.25</cla><cda>0.10</cda><area>0.01</area><air_density>1.2041</air_density>
      <cp>-0.005 0 0</cp><forward>0 -1 0</forward><upward>0 0 1</upward><link_name>rotor_2</link_name>
    </plugin>

    <link name='rotor_3'><pose>-0.31 -0.18 0.02 0 0 0</pose>
      <inertial><mass>0.02</mass><inertia><ixx>1e-5</ixx><iyy>1e-5</iyy><izz>1e-5</izz></inertia></inertial>
      <visual name='v'><geometry><mesh><scale>0.7 0.7 0.7</scale><uri>model://standard_vtol/meshes/iris_prop_cw.dae</uri></mesh></geometry><material><ambient>0 0 1 1</ambient><diffuse>0 0 1 1</diffuse></material></visual>
    </link>
    <joint name='rotor_3_joint' type='revolute'><child>rotor_3</child><parent>base_link</parent><axis><xyz>0 0 1</xyz></axis></joint>
    <plugin filename="gz-sim-lift-drag-system" name="gz::sim::systems::LiftDrag">
      <a0>0.3</a0><cla>4.25</cla><cda>0.10</cda><area>0.01</area><air_density>1.2041</air_density>
      <cp>-0.005 0 0</cp><forward>0 -1 0</forward><upward>0 0 1</upward><link_name>rotor_3</link_name>
    </plugin>

    <link name='rotor_pusher'><pose>-0.18 0 0 0 0 0</pose>
      <inertial><mass>0.02</mass><inertia><ixx>1e-5</ixx><iyy>1e-5</iyy><izz>1e-5</izz></inertia></inertial>
      <visual name='v'>
        <pose>0 0 0 0 1.5707 0</pose> <geometry><mesh><scale>1.0 1.0 1.0</scale><uri>model://standard_vtol/meshes/iris_prop_ccw.dae</uri></mesh></geometry>
        <material><ambient>0 0 1 1</ambient><diffuse>0 0 1 1</diffuse></material>
      </visual>
    </link>
    <joint name='rotor_pusher_joint' type='revolute'><child>rotor_pusher</child><parent>base_link</parent><axis><xyz>1 0 0</xyz></axis></joint>
    <plugin filename="gz-sim-lift-drag-system" name="gz::sim::systems::LiftDrag">
      <a0>0.3</a0><cla>4.25</cla><cda>0.10</cda><area>0.02</area><air_density>1.2041</air_density>
      <cp>0.01 0 0</cp>
      <forward>0 0 1</forward> <upward>1 0 0</upward>  <link_name>rotor_pusher</link_name>
    </plugin>

    <link name="left_elevon"><inertial><mass>0.05</mass><inertia><ixx>1e-4</ixx><iyy>1e-4</iyy><izz>1e-4</izz></inertia></inertial><visual name='v'><geometry><mesh><scale>0.52 0.52 0.52</scale><uri>model://standard_vtol/meshes/x8_elevon_left.dae</uri></mesh></geometry><material><ambient>0 0 1 1</ambient><diffuse>0 0 1 1</diffuse></material></visual></link>
    <joint name='left_elevon_joint' type='revolute'><parent>base_link</parent><child>left_elevon</child><pose>-0.25 0.40 0 0 0 0</pose><axis><xyz>0 1 0</xyz><limit><lower>-0.53</lower><upper>0.53</upper></limit><dynamics><damping>1.0</damping><spring_stiffness>50.0</spring_stiffness></dynamics></axis></joint>
    
    <link name="right_elevon"><inertial><mass>0.05</mass><inertia><ixx>1e-4</ixx><iyy>1e-4</iyy><izz>1e-4</izz></inertia></inertial><visual name='v'><geometry><mesh><scale>0.52 0.52 0.52</scale><uri>model://standard_vtol/meshes/x8_elevon_right.dae</uri></mesh></geometry><material><ambient>0 0 1 1</ambient><diffuse>0 0 1 1</diffuse></material></visual></link>
    <joint name='right_elevon_joint' type='revolute'><parent>base_link</parent><child>right_elevon</child><pose>-0.25 -0.40 0 0 0 0</pose><axis><xyz>0 1 0</xyz><limit><lower>-0.53</lower><upper>0.53</upper></limit><dynamics><damping>1.0</damping><spring_stiffness>50.0</spring_stiffness></dynamics></axis></joint>
    
    <plugin filename="gz-sim-lift-drag-system" name="gz::sim::systems::LiftDrag"><a0>0.15</a0><cla>6.8</cla><cda>0.06</cda><area>0.04</area><air_density>1.2041</air_density><forward>1 0 0</forward><upward>0 0 1</upward><link_name>base_link</link_name><control_joint_name>left_elevon_joint</control_joint_name><control_joint_rad_to_cl>-4.0</control_joint_rad_to_cl></plugin>
    <plugin filename="gz-sim-lift-drag-system" name="gz::sim::systems::LiftDrag"><a0>0.15</a0><cla>6.8</cla><cda>0.06</cda><area>0.04</area><air_density>1.2041</air_density><forward>1 0 0</forward><upward>0 0 1</upward><link_name>base_link</link_name><control_joint_name>right_elevon_joint</control_joint_name><control_joint_rad_to_cl>-4.0</control_joint_rad_to_cl></plugin>

    <link name='imu_link'><inertial><mass>0.001</mass><inertia><ixx>1e-9</ixx><iyy>1e-9</iyy><izz>1e-9</izz></inertia></inertial><sensor name="imu_sensor" type="imu"><always_on>1</always_on><update_rate>1000.0</update_rate></sensor></link>
    <joint name='imu_joint' type='fixed'><child>imu_link</child><parent>base_link</parent></joint>

    <plugin filename="gz-sim-joint-state-publisher-system" name="gz::sim::systems::JointStatePublisher"></plugin>
    <plugin filename="gz-sim-apply-joint-force-system" name="gz::sim::systems::ApplyJointForce"><joint_name>rotor_0_joint</joint_name></plugin>
    <plugin filename="gz-sim-apply-joint-force-system" name="gz::sim::systems::ApplyJointForce"><joint_name>rotor_1_joint</joint_name></plugin>
    <plugin filename="gz-sim-apply-joint-force-system" name="gz::sim::systems::ApplyJointForce"><joint_name>rotor_2_joint</joint_name></plugin>
    <plugin filename="gz-sim-apply-joint-force-system" name="gz::sim::systems::ApplyJointForce"><joint_name>rotor_3_joint</joint_name></plugin>
    <plugin filename="gz-sim-apply-joint-force-system" name="gz::sim::systems::ApplyJointForce"><joint_name>rotor_pusher_joint</joint_name></plugin>
    <plugin filename="gz-sim-apply-joint-force-system" name="gz::sim::systems::ApplyJointForce"><joint_name>left_elevon_joint</joint_name></plugin>
    <plugin filename="gz-sim-apply-joint-force-system" name="gz::sim::systems::ApplyJointForce"><joint_name>right_elevon_joint</joint_name></plugin>

    <plugin name="ArduPilotPlugin" filename="/home/eizmecha/ardupilot_gazebo/build/libArduPilotPlugin.so">
      <connectionTimeoutMaxCount>5</connectionTimeoutMaxCount>
      <lock_step>1</lock_step>
      <modelXYZToAirplaneXForwardZDown degrees="true">0 0 0 180 0 0</modelXYZToAirplaneXForwardZDown>
      <gazeboXYZToNED degrees="true">0 0 0 180 0 90</gazeboXYZToNED>
      <imuName>imu_sensor</imuName>
      <control channel="0"><jointName>left_elevon_joint</jointName><useForce>1</useForce><multiplier>1.0</multiplier><offset>-0.5</offset><servo_min>1000</servo_min><servo_max>2000</servo_max><type>POSITION</type><p_gain>10.0</p_gain></control>
      <control channel="1"><jointName>right_elevon_joint</jointName><useForce>1</useForce><multiplier>1.0</multiplier><offset>-0.5</offset><servo_min>1000</servo_min><servo_max>2000</servo_max><type>POSITION</type><p_gain>10.0</p_gain></control>
      <control channel="2"><jointName>rotor_pusher_joint</jointName><useForce>1</useForce><multiplier>3000</multiplier><offset>0</offset><servo_min>1000</servo_min><servo_max>2000</servo_max><type>VELOCITY</type><p_gain>0.20</p_gain><cmd_max>50.0</cmd_max><cmd_min>-50.0</cmd_min></control>
      <control channel="4"><jointName>rotor_0_joint</jointName><useForce>1</useForce><multiplier>-5000</multiplier><offset>0</offset><servo_min>1000</servo_min><servo_max>2000</servo_max><type>VELOCITY</type><p_gain>0.50</p_gain><cmd_max>100.0</cmd_max><cmd_min>-100.0</cmd_min></control>
      <control channel="5"><jointName>rotor_1_joint</jointName><useForce>1</useForce><multiplier>-5000</multiplier><offset>0</offset><servo_min>1000</servo_min><servo_max>2000</servo_max><type>VELOCITY</type><p_gain>0.50</p_gain><cmd_max>100.0</cmd_max><cmd_min>-100.0</cmd_min></control>
      <control channel="6"><jointName>rotor_2_joint</jointName><useForce>1</useForce><multiplier>5000</multiplier><offset>0</offset><servo_min>1000</servo_min><servo_max>2000</servo_max><type>VELOCITY</type><p_gain>0.50</p_gain><cmd_max>100.0</cmd_max><cmd_min>-100.0</cmd_min></control>
      <control channel="7"><jointName>rotor_3_joint</jointName><useForce>1</useForce><multiplier>5000</multiplier><offset>0</offset><servo_min>1000</servo_min><servo_max>2000</servo_max><type>VELOCITY</type><p_gain>0.50</p_gain><cmd_max>100.0</cmd_max><cmd_min>-100.0</cmd_min></control>
    </plugin>
  </model>
</sdf>
